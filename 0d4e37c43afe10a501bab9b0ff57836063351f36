{
  "comments": [
    {
      "key": {
        "uuid": "9a561d44_41e22fa0",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-08T11:03:30Z",
      "side": 1,
      "message": "The copyright header should follow the opnfv format\nCheck https://github.com/opnfv/armband/blob/master/ci/deploy.sh",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_93777802",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 1306
      },
      "writtenOn": "2018-08-10T09:29:47Z",
      "side": 1,
      "message": "actually, this is the exact license header as it is defined in the attachment of Apache 2.0 license:\n\nhttps://www.apache.org/licenses/LICENSE-2.0",
      "parentUuid": "9a561d44_41e22fa0",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_a1eeab89",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-08T11:03:30Z",
      "side": 1,
      "message": "Is this a pre-requisite? I suspect the script can be reused in other labs, so maybe rephrase it to say that this is where the script is tested",
      "range": {
        "startLine": 17,
        "startChar": 61,
        "endLine": 18,
        "endChar": 13
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_d360d037",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1306
      },
      "writtenOn": "2018-08-10T09:29:47Z",
      "side": 1,
      "message": "My intention was to emphasise that it is currently being developed and tested only at LAAS. The plan is to make it more generic to be executable also at baremetal pods etc. However until then I would like to keep this note here - so anybody is aware that execution at non-LAAS environment is on his/her own risk.",
      "parentUuid": "9a561d44_a1eeab89",
      "range": {
        "startLine": 17,
        "startChar": 61,
        "endLine": 18,
        "endChar": 13
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_5c896dc9",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 31,
      "author": {
        "id": 7223
      },
      "writtenOn": "2018-08-13T21:44:23Z",
      "side": 1,
      "message": "Maybe creating password-less users is dangerous ? (if this is ever used in production down the road)\nCould you spell out the steps/commands to prepare password-less SSH access (even in comments) ? Would there be a way to automate this as well ?\nIt seems there is a default \"opnfv\" user created on Pharos UNH servers: should Auto use a different new user, like \"opnfvauto\" for example ?",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_888d7f7e",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 31,
      "author": {
        "id": 7089
      },
      "writtenOn": "2018-08-16T15:11:17Z",
      "side": 1,
      "message": "As this script is currently being setup for the LaaS servers it uses the default opnfv user which is setup automatically when you book a server. This way you only need to book the machines and, when they are ready, run the script without having to connect to them first.\n\nIf you have setup keys for ssh with the \"ssh-keygen\" command you can then setup password-less SSH access with \"ssh-copy-id \u003cuser\u003e@\u003cserver-IP\u003e\". You will be prompted for the user password, so it would be hard to automate with LaaS, as the passwords are sent to your email. I think this part will always require some manual user input.",
      "parentUuid": "9a561d44_5c896dc9",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_018677b9",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-08T11:03:30Z",
      "side": 1,
      "message": "Overall comment for the document: I recommend to keep the 80 chars line length for all the document\nAlso use https://www.shellcheck.net/ to follow shell scripting good practices",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_b3655c47",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1306
      },
      "writtenOn": "2018-08-10T09:29:47Z",
      "side": 1,
      "message": "Thanks for the hint. We will take it into account.",
      "parentUuid": "9a561d44_018677b9",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_68962b96",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 7089
      },
      "writtenOn": "2018-08-16T15:11:17Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9a561d44_018677b9",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_21029b3e",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-08T11:03:30Z",
      "side": 1,
      "message": "This script will be cleaner if you use a packages.txt file to list the per-requisites and do something like \"xargs -a packages.txt sudo apt-get install\" here. It will also make it easier to update the list of packages.",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 52,
        "endChar": 40
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_f35fd470",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1306
      },
      "writtenOn": "2018-08-10T09:29:47Z",
      "side": 1,
      "message": "I suppose that you\u0027re referring to OS packages installed via apt (currently 2 of them). I agree that in general the proposed approach is better. However in this case, the installation is performed remotely and it would require an additional SCP. It\u0027s a bit of overhead for two package. Thus I would recommend to put the list of packages to the variable instead. If the number of packages will grow significantly in the future, we can move it to separate file anytime.",
      "parentUuid": "9a561d44_21029b3e",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 52,
        "endChar": 40
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_e72c2e4d",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-14T08:44:09Z",
      "side": 1,
      "message": "Yes, I was referring to those. Variable with list of packages works as well. It\u0027s easier to have them all in one place. The same logic should apply to the packages that you install on master (or any other target)\n\nAlso, maybe it\u0027s worth moving to  a separate script the commands that need to be executed remote, scp it and run it there directly. I advocate for small files with a precise purpose than one big file with everything in.",
      "parentUuid": "9a561d44_f35fd470",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 52,
        "endChar": 40
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_489367a3",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 7089
      },
      "writtenOn": "2018-08-16T15:11:17Z",
      "side": 1,
      "message": "For most of the packages the order of operation is important so I do not believe that creating a variable for this would be effective. Creating a list of all the installed packages in another file for reference could be an option.\n\nThe problem with creating multiple scripts is the need to change some arguments on both the ssh client(package versions, client IP addresses) and the ssh server(ID of new environment, rancher registration tokens).",
      "parentUuid": "9a561d44_e72c2e4d",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 52,
        "endChar": 40
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_41906fec",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 175,
      "author": {
        "id": 5267
      },
      "writtenOn": "2018-08-08T11:03:30Z",
      "side": 1,
      "message": "I suggest you move this into a separate file with default values and only update it in this script. You can use sed for the updates",
      "range": {
        "startLine": 158,
        "startChar": 0,
        "endLine": 175,
        "endChar": 33
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_734bc4b0",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 175,
      "author": {
        "id": 1306
      },
      "writtenOn": "2018-08-10T09:29:47Z",
      "side": 1,
      "message": "Thanks for the suggestion. We will consider it, if this part will make to the final version.",
      "parentUuid": "9a561d44_41906fec",
      "range": {
        "startLine": 158,
        "startChar": 0,
        "endLine": 175,
        "endChar": 33
      },
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_3c8639ba",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 230,
      "author": {
        "id": 7223
      },
      "writtenOn": "2018-08-13T21:44:23Z",
      "side": 1,
      "message": "Sometimes, during pod deployment, using the kubectl commands, getting this error:\n\"error: You must be logged in to the server (Unauthorized)\", and sometimes not (it depends, from one minute to the next). What could be the cause ?\nNote: if it keeps not working, disconnecting/reconnecting to the master node allows for the kubectl commands to work again (but still intermittently). \nAfter more than 2h30 minutes, stuck at this:\n     23 ContainerCreating\n      3 CrashLoopBackOff\n     43 Init:0/1\n      4 Init:0/2\n      7 Init:1/2\n     65 Running",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a561d44_a8904396",
        "filename": "ci/deploy-onap.sh",
        "patchSetId": 1
      },
      "lineNbr": 230,
      "author": {
        "id": 7089
      },
      "writtenOn": "2018-08-16T15:11:17Z",
      "side": 1,
      "message": "I have encountered problems with kubectl while certain pods were taxing the server\u0027s resources too much, but I will look into it further.\n\nWith the new version of the script there are about 13 pending pods out of the total of 154 after about 1 hour of run-time. There were multiple operations that needed more time to setup properly, so multiple sleep commands were added to ease the environment ramp-up.",
      "parentUuid": "9a561d44_3c8639ba",
      "revId": "0d4e37c43afe10a501bab9b0ff57836063351f36",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    }
  ]
}